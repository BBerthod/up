# Up — Uptime Monitoring Service

## Overview

Open-source, self-hostable uptime monitoring service. Clean codebase, modern UI, Dokploy-ready.

**Repository:** github.com/BBerthod/up

## Tech Stack

| Layer | Technology |
|-------|-----------|
| Backend | Laravel 11 (PHP 8.4) |
| Frontend | Vue 3 + Inertia.js |
| Database | PostgreSQL 16 |
| Cache/Queue | Redis 7 |
| WebSockets | Laravel Reverb |
| CSS | Tailwind CSS + shadcn-vue |
| PWA | Service Worker + Web Push API |
| Deployment | Docker Compose (Dokploy-ready) |
| Auth | Laravel Sanctum (web + API tokens) |

## Architecture

```
┌─────────────────────────────────────────────┐
│              Laravel 11 + Inertia           │
│  ┌──────────┐  ┌──────────┐  ┌───────────┐ │
│  │   Web    │  │   API    │  │  Status   │ │
│  │  (Vue 3) │  │  REST    │  │  Pages    │ │
│  └──────────┘  └──────────┘  └───────────┘ │
├─────────────────────────────────────────────┤
│              Services Layer                  │
│  MonitorService · CheckService              │
│  NotificationService · StatusPageService    │
├─────────────────────────────────────────────┤
│    Queue Workers (Redis) + Reverb (WS)      │
│  ┌────────────┐  ┌─────────────────┐        │
│  │ Check Jobs │  │ Notification    │        │
│  │ (1/min)    │  │ Jobs            │        │
│  └────────────┘  └─────────────────┘        │
├─────────────────────────────────────────────┤
│         PostgreSQL · Redis                   │
└─────────────────────────────────────────────┘
```

### Check Flow

1. Scheduler (`everyMinute()`) dispatches `DispatchChecks` job
2. `DispatchChecks` queries all active monitors due for check, dispatches `RunCheck` per monitor
3. `RunCheck` executes HTTP request, records result (status, response time, SSL info)
4. If state change (up->down or down->up) -> creates/resolves incident, dispatches `SendNotification` jobs
5. `RunCheck` broadcasts result via Reverb -> dashboard updates in real-time
6. Results feed status pages and dashboard

## Data Model

```sql
teams
  id, name, created_at

users
  id, team_id, name, email, password, created_at, updated_at

monitors
  id, team_id, name, url
  method (GET/POST/HEAD, default GET)
  expected_status_code (default 200)
  keyword (nullable, keyword check)
  interval (minutes, default 1)
  is_active (default true)
  last_checked_at (nullable)
  created_at, updated_at

monitor_checks
  id, monitor_id
  status (up/down)
  response_time_ms
  status_code
  ssl_expires_at (nullable)
  error_message (nullable)
  checked_at

monitor_incidents
  id, monitor_id
  started_at
  resolved_at (nullable)
  cause (timeout/status_code/keyword/ssl/error)

notification_channels
  id, team_id
  type (email/webhook/slack/discord/push)
  settings (jsonb)
  is_active (default true)
  created_at, updated_at

monitor_notification_channel (pivot)
  monitor_id, notification_channel_id

status_pages
  id, team_id, name, slug (unique)
  is_public (default true)
  created_at, updated_at

status_page_monitor (pivot)
  status_page_id, monitor_id, sort_order
```

## Pages & UI

### Authenticated Pages

- **Dashboard** — Monitor list with real-time status (live via WebSocket), uptime %, response time. Filter by status.
- **Monitor Detail** — Response time chart (30 days), uptime bar (90 days), incident history, edit/delete/pause.
- **Create/Edit Monitor** — URL, name, method, interval, expected status, keyword, notification channels.
- **Notification Channels** — CRUD for email/webhook/slack/discord/push channels.
- **Status Pages** — Manage public status pages, select monitors to display.
- **Team Settings** — Members, API tokens.

### Public Pages

- **Status Page** (`/status/{slug}`) — Current state per monitor, 90-day uptime bars, active incidents.

### Design System (Radiank-inspired)

- **Background:** Navy `#0a0f1a`
- **Accent primary:** Cyan `rgb(6, 182, 212)`
- **Status up:** Emerald `rgb(16, 185, 129)`
- **Status down:** Red `rgb(239, 68, 68)`
- **Typography:** Inter (UI) + JetBrains Mono (technical data)
- **Effects:** Glassmorphism cards, transparent borders, subtle animations
- **Dark/Light mode toggle** (dark default, light option on status pages)
- **PWA:** Installable, push notifications, offline dashboard shell

## Notifications

| Channel | Implementation |
|---------|---------------|
| Email | Laravel Mail |
| Webhook | HTTP POST with JSON payload |
| Slack | Slack Incoming Webhook URL |
| Discord | Discord Webhook URL |
| Push (PWA) | Web Push API + service worker |

### Notification Payload (webhook)

```json
{
  "monitor": { "id": 1, "name": "My Site", "url": "https://example.com" },
  "event": "monitor.down",
  "incident": { "id": 5, "cause": "status_code", "started_at": "2026-02-15T10:30:00Z" },
  "check": { "status_code": 503, "response_time_ms": 2340 }
}
```

## API (REST)

Auth: Bearer token (Sanctum).

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | /api/monitors | List monitors |
| POST | /api/monitors | Create monitor |
| GET | /api/monitors/{id} | Monitor detail |
| PUT | /api/monitors/{id} | Update monitor |
| DELETE | /api/monitors/{id} | Delete monitor |
| GET | /api/monitors/{id}/checks | Check history |
| GET | /api/monitors/{id}/incidents | Incident history |
| POST | /api/monitors/{id}/pause | Pause monitor |
| POST | /api/monitors/{id}/resume | Resume monitor |
| GET | /api/notification-channels | List channels |
| POST | /api/notification-channels | Create channel |
| PUT | /api/notification-channels/{id} | Update channel |
| DELETE | /api/notification-channels/{id} | Delete channel |
| GET | /api/status-pages | List status pages |
| POST | /api/status-pages | Create status page |
| PUT | /api/status-pages/{id} | Update status page |
| DELETE | /api/status-pages/{id} | Delete status page |

## Docker Compose (Dokploy-ready)

```yaml
services:
  app:        # Nginx + PHP-FPM (Laravel + Inertia SSR)
  worker:     # php artisan queue:work redis
  scheduler:  # php artisan schedule:work
  reverb:     # php artisan reverb:start
  postgres:   # PostgreSQL 16
  redis:      # Redis 7 (queue + cache + Reverb)
```

Single `docker-compose.yml`, one-click deploy on Dokploy.

## Project Structure

```
up/
├── app/
│   ├── Services/           # MonitorService, CheckService, NotificationService
│   ├── Jobs/               # RunCheck, SendNotification, DispatchChecks
│   ├── Models/             # Team, User, Monitor, MonitorCheck, etc.
│   ├── Events/             # MonitorChecked, MonitorDown, MonitorUp
│   ├── Http/
│   │   ├── Controllers/    # Web controllers (Inertia)
│   │   └── Api/            # API controllers
│   └── Notifications/      # Email, Slack, Discord, Webhook, Push
├── resources/
│   ├── js/
│   │   ├── Pages/          # Vue 3 Inertia pages
│   │   ├── Components/     # Reusable UI components
│   │   ├── Composables/    # useMonitor, useWebSocket, etc.
│   │   └── Layouts/        # App layout, Status page layout
│   └── css/
├── routes/
│   ├── web.php
│   ├── api.php
│   └── channels.php        # Reverb channel authorization
├── docker-compose.yml
├── Dockerfile
├── docs/
│   └── api.md
└── README.md
```

## Real-time (Laravel Reverb)

- `MonitorChecked` event broadcast on `team.{teamId}` private channel
- Dashboard listens via Echo, updates monitor status/response time instantly
- Status dot pulses on state change
- No page refresh needed

## Additional Features

### Lighthouse Score (periodic)

- Daily Lighthouse audit per monitor via `spatie/lighthouse-php` or headless Chrome
- Scores stored: performance, accessibility, best practices, SEO
- Historical chart on monitor detail page
- Table: `monitor_lighthouse_scores (id, monitor_id, performance, accessibility, best_practices, seo, scored_at)`

### CLI Companion (`up-cli`)

- NPM package: `npx up-cli`
- Commands: `up add <url>`, `up list`, `up rm <id>`, `up status`, `up pause <id>`
- Auth via API token (`up login <token>`)
- Uses the REST API

### Badge/Widget Embeddable

- Endpoint: `GET /badge/{monitor_hashid}.svg`
- Dynamic SVG badge showing uptime % (green/yellow/red)
- Markdown: `![Uptime](https://up.example.com/badge/abc123.svg)`
- No auth required (public)

### Response Time Alerting

- Per-monitor configurable thresholds: `warning_threshold_ms`, `critical_threshold_ms`
- Alert when response time exceeds threshold for N consecutive checks
- Graphique with colored threshold zones (green/yellow/red)
- Table addition: `monitors.warning_threshold_ms (nullable)`, `monitors.critical_threshold_ms (nullable)`

### Latency Heatmap

- GitHub-style contribution heatmap showing daily avg response time over 12 months
- Green (fast) -> Yellow (moderate) -> Red (slow)
- Displayed on monitor detail page
- Aggregated from `monitor_checks` table

### Team Dashboard (Global Metrics)

- Overview page with aggregated stats:
  - Total checks today / this month
  - Average uptime across all monitors
  - Average response time global
  - Active incidents count
  - Monitors by status (up/down/paused)
- Displayed as cards with sparklines

## MVP Scope Summary

### Core
- HTTP(s) monitoring with keyword check & SSL expiry
- 1-minute minimum interval
- Multi-tenant (team-based)
- Real-time dashboard (WebSocket via Reverb)
- Notifications: email, webhook, Slack, Discord, PWA push
- Public status pages
- REST API with Sanctum auth
- PWA (installable, push notifications)
- Dark/Light mode (Radiank design)
- Docker Compose for Dokploy
- 1 monitoring location

### Bonus Features
- Lighthouse score (daily audit)
- CLI companion (`up-cli`)
- Badge SVG embeddable
- Response time alerting (thresholds)
- Latency heatmap (12 months)
- Team dashboard (global metrics)
